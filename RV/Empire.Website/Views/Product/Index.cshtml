@using System.Globalization
@using Empire.DataAccessLayer
@using Empire.Website.Helpers

@model IEnumerable<Product>

@{
	ViewBag.Title = TranslationHelper.Translate(CultureInfo.CurrentCulture.Name, "Product.Title");
}

<h2>@ViewBag.Title</h2>

@foreach (Product product in Model)
{
	<div style="padding-top: 20px;">
		<span>@Html.DisplayFor(modelItem => product.Name)</span>

		<a onclick="showDetails(@product.Id)">Details</a>

		<div id="details_@product.Id" style="display: none; border: 1px solid black; padding: 10px">
			<div id="description_@product.Id"></div>
			<div id="price_@product.Id"></div>
		</div>
	</div>
}

<script>

	function showDetails(productId) {
		if ($("#details_" + productId).is(":visible")) {
			$("#description_" + productId).html("");
			$("#price_" + productId).html("");
			$("#details_" + productId).css("display", "none");
		} else {
			$.ajax({
				url: "/Product/Details",
				data: { productId: productId },
				datatype: "json",
				type: "GET",
				success: function (data) {
					$("#description_" + productId).html(data.Description);
					$("#price_" + productId).html(data.PriceFormatted);
					$("#details_" + productId).css("display", "block");
				}
			});
		}
	}

</script>
